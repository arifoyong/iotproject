(this.webpackJsonpfrntend=this.webpackJsonpfrntend||[]).push([[0],{106:function(e,t,a){},107:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(17),c=a.n(l),o=(a(80),a(81),a(29)),i=a(23),u=a(42),m=a(41),d=function(){return r.a.createElement(u.a,{bg:"light",expand:"lg"},r.a.createElement(u.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(u.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(m.a,{className:"mr-auto"},r.a.createElement(m.a.Link,{href:"/"},"Home"),r.a.createElement(m.a.Link,{href:"/setting"},"Setting"))))},p=a(14),s=a(66),h=a(28),E=a(25),b=a(31),f=a(33),y=a(65),v=a(5),g=a(22),O=a(10);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(a,!0).forEach((function(t){Object(b.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var w=function(e){var t=e.show,a=e.handleClose,l=e.updateData,c=Object(n.useState)({}),o=Object(p.a)(c,2),i=o[0],u=o[1];Object(n.useEffect)((function(){var t="/api/device/".concat(e.idNo);fetch(t).then((function(e){return e.json()})).then((function(e){u(e)}))}),[e.idNo]);var m=function(e){e.persist(),"alertActive"===e.target.name?u((function(t){return C({},t,Object(b.a)({},e.target.name,e.target.checked))})):u((function(t){return C({},t,Object(b.a)({},e.target.name,e.target.value))}))};return r.a.createElement(f.a,{size:"lg",show:t,onHide:a},r.a.createElement(f.a.Header,{closeButton:!0},r.a.createElement(f.a.Title,null,"Edit Device Settings")),r.a.createElement(f.a.Body,null,r.a.createElement(v.a,null,r.a.createElement(g.a,null,r.a.createElement(O.a,null,r.a.createElement(v.a.Group,{controlId:"deviceId"},r.a.createElement(v.a.Label,null,"Device ID"),r.a.createElement(v.a.Control,{disabled:!0,type:"number",name:"id",value:i.id,onChange:m})),r.a.createElement(v.a.Group,{controlId:"location"},r.a.createElement(v.a.Label,null,"Location"),r.a.createElement(v.a.Control,{type:"text",name:"location",value:i.location,onChange:m})),r.a.createElement(v.a.Group,{controlId:"alertactive"},r.a.createElement(v.a.Check,{type:"checkbox",label:"Activate alert",name:"alertActive",checked:i.alertActive,onChange:m}))),r.a.createElement(O.a,null,r.a.createElement(v.a.Group,{controlId:"temp_lcl"},r.a.createElement(v.a.Label,null,"Temperature LCL"),r.a.createElement(v.a.Control,{type:"number",name:"temp_lcl",value:i.temp_lcl,onChange:m})),r.a.createElement(v.a.Group,{controlId:"temp_ucl"},r.a.createElement(v.a.Label,null,"Temperature UCL"),r.a.createElement(v.a.Control,{type:"number",name:"temp_ucl",value:i.temp_ucl,onChange:m})),r.a.createElement(v.a.Group,{controlId:"humi_lcl"},r.a.createElement(v.a.Label,null,"Humidity LCL"),r.a.createElement(v.a.Control,{type:"number",name:"humi_lcl",value:i.humi_lcl,onChange:m})),r.a.createElement(v.a.Group,{controlId:"humi_ucl"},r.a.createElement(v.a.Label,null,"Humidity UCL"),r.a.createElement(v.a.Control,{type:"number",name:"humi_ucl",value:i.humi_ucl,onChange:m})),r.a.createElement(v.a.Group,{controlId:"batt_lcl"},r.a.createElement(v.a.Label,null,"Battery LCL"),r.a.createElement(v.a.Control,{type:"number",name:"batt_lcl",value:i.batt_lcl,onChange:m})),r.a.createElement(v.a.Group,{controlId:"batt_ucl"},r.a.createElement(v.a.Label,null,"Battery UCL"),r.a.createElement(v.a.Control,{type:"number",name:"batt_ucl",value:i.batt_ucl,onChange:m})))),r.a.createElement(y.a,null,r.a.createElement(E.a,{className:"mybtn",variant:"primary",type:"submit",onClick:function(e){e.preventDefault(),fetch("/api/device",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(e){e.ok?l():console.log("Failed to update data")})),a()}},"Submit"),r.a.createElement(E.a,{className:"mybtn",variant:"danger",onClick:a},"Cancel")))))},D="/api/device";var L=function(){var e=Object(n.useState)([]),t=Object(p.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(1),o=Object(p.a)(c,2),i=o[0],u=o[1],m=Object(n.useState)(!1),d=Object(p.a)(m,2),b=d[0],f=d[1],y=function(e){f(!0),u(e.target.id)},v=function(){fetch(D).then((function(e){return e.json()})).then((function(e){l(e)}))};return Object(n.useEffect)((function(){v()}),[]),r.a.createElement(h.a,{className:"table-container",fluid:"true"},r.a.createElement(s.a,{responsive:"md",hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"ID"),r.a.createElement("th",null,"Location"),r.a.createElement("th",null,"Alert Active"),r.a.createElement("th",null,"Temp LCL"),r.a.createElement("th",null,"Temp UCL"),r.a.createElement("th",null,"Humi LCL"),r.a.createElement("th",null,"Humi UCL"),r.a.createElement("th",null,"Batt LCL"),r.a.createElement("th",null,"Batt UCL"),r.a.createElement("th",null))),r.a.createElement("tbody",null,a.map((function(e,t){return function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("th",{scope:"row"},e.id),r.a.createElement("td",null,e.location),r.a.createElement("td",null,e.alertActive?"True":"False"),r.a.createElement("td",null,e.temp_lcl),r.a.createElement("td",null,e.temp_ucl),r.a.createElement("td",null,e.humi_lcl),r.a.createElement("td",null,e.humi_ucl),r.a.createElement("td",null,e.batt_lcl),r.a.createElement("td",null,e.batt_ucl),r.a.createElement("td",null,r.a.createElement(E.a,{id:e.id,variant:"primary",onClick:y},"Edit")))}(e,t)})))),r.a.createElement(w,{show:b,handleClose:function(){return f(!1)},updateData:v,idNo:i}))},_=a(20),k="/api/record/lastrecord",S=function(e,t){return r.a.createElement(O.a,{key:t,xs:12,md:6,lg:4},r.a.createElement(_.a,null,r.a.createElement(o.b,{className:"btn btn-primary",to:{pathname:"/graph/".concat(e.deviceId)}},r.a.createElement(_.a.Header,null,"ID: ",e.deviceId," @ ",e.device.location)),r.a.createElement(_.a.Body,null,r.a.createElement(g.a,null,r.a.createElement(O.a,null,r.a.createElement(_.a.Text,null,"Temperature"),r.a.createElement(_.a.Text,null,e.temp,"\xb0C")),r.a.createElement(O.a,null,r.a.createElement(_.a.Text,null,"Humidity"),r.a.createElement(_.a.Text,null,e.humi,"%"))),r.a.createElement(g.a,null,r.a.createElement(O.a,null,r.a.createElement(_.a.Text,{className:"last-update-time"},"Last update: ",function(e){var t=new Date(e),a=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes();return t.getDate()+"-"+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]+"-"+t.getFullYear()+" "+t.getHours()+":"+a}(e.recordDate)))))))};var x=function(){var e=Object(n.useState)([]),t=Object(p.a)(e,2),a=t[0],l=t[1];return Object(n.useEffect)((function(){fetch(k).then((function(e){return e.json()})).then((function(e){l(e)}))}),[]),r.a.createElement(h.a,null,r.a.createElement(g.a,null,a.map((function(e,t){return S(e,t)}))))},I=a(69),P=a(70),T=a(73),M=a(71),H=a(38),N=a(74),A=a(72),W=a.n(A),z=function(e){function t(e){var a;return Object(I.a)(this,t),(a=Object(T.a)(this,Object(M.a)(t).call(this,e))).drawLineChart=function(){var e=a.state.width,t=e>480?12:8;a.lineChart=new W.a(a.chartRef.current.getContext("2d"),{type:"line",data:{datasets:a.props.tempData},options:{responsive:!0,maintainAspectRatio:!0,legend:{display:e>480,position:"bottom",fontSize:t},title:{display:!0,text:a.props.title,fontSize:1.2*t},scales:{xAxes:[{type:"time",time:{unit:"hour",unitStepSize:.5,round:"hour",tooltipFormat:"h:mm:ss a",displayFormats:{hour:"MMM D, h:mm a"}},ticks:{fontSize:t,minRotation:0,maxRotation:12}}],yAxes:[{type:"linear",ticks:{min:a.props.yMin,max:a.props.yMax,fontSize:t},scaleLabel:{display:!0,labelString:a.props.yLabel,fontSize:t}}]}}})},a.state={width:0,height:0},a.chartRef=r.a.createRef(),a.updateWindowDimensions=a.updateWindowDimensions.bind(Object(H.a)(a)),a}return Object(N.a)(t,e),Object(P.a)(t,[{key:"componentDidUpdate",value:function(){this.drawLineChart()}},{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"render",value:function(){return r.a.createElement("div",{id:"canvas-holder"},r.a.createElement("canvas",{id:"myChart",style:{},ref:this.chartRef}))}}]),t}(r.a.Component);function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var G={label:"",borderColor:"red",data:[],fill:!1,borderDash:[10,5],pointRadius:0,borderWidth:1},R=function(e,t,a,n,r,l){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(a,!0).forEach((function(t){Object(b.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},G,{label:e,borderColor:t,data:a,borderDash:n,pointRadius:r,borderWidth:l})};var U=function(){var e=Object(i.f)().id,t=Object(n.useState)([]),a=Object(p.a)(t,2),l=a[0],c=a[1],u=[R("temp","blue",l.map((function(e){return{t:e.recordDate,y:e.temp}})),[],3,2),R("temp_ucl","purple",l.map((function(e){return{t:e.recordDate,y:e.device.temp_ucl}})),[10,5],0,1),R("temp_lcl","green",l.map((function(e){return{t:e.recordDate,y:e.device.temp_lcl}})),[10,5],0,1)],m=[R("humi","blue",l.map((function(e){return{t:e.recordDate,y:e.humi}})),[],3,2),R("humi_ucl","purple",l.map((function(e){return{t:e.recordDate,y:e.device.humi_ucl}})),[10,5],0,1),R("humi_lcl","green",l.map((function(e){return{t:e.recordDate,y:e.device.humi_lcl}})),[10,5],0,1)];return Object(n.useEffect)((function(){var t="/api/record/".concat(e,"/24");fetch(t).then((function(e){return e.json()})).then((function(e){c(e)}))}),[e]),r.a.createElement(h.a,{fluid:"false",className:"graph-container"},r.a.createElement(E.a,{variant:"outline-primary"},r.a.createElement(o.b,{to:"/"},"back")),r.a.createElement(g.a,null,r.a.createElement(O.a,{md:12,lg:6},r.a.createElement(z,{title:"Temperature (ID: ".concat(e,")"),yLabel:"Temperature (deg C)",yMin:10,yMax:40,tempData:u})),r.a.createElement(O.a,{md:12,lg:6},r.a.createElement(z,{title:"Humidity (ID: ".concat(e,")"),yLabel:"Humidity (%)",yMin:40,yMax:100,tempData:m}))))};a(106);var F=function(){return r.a.createElement(o.a,null,r.a.createElement(d,null),r.a.createElement("div",{className:"container-fluid"},r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/",component:x}),r.a.createElement(i.a,{exact:!0,path:"/setting",component:L}),r.a.createElement(i.a,{exact:!0,path:"/graph/:id",component:U}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},75:function(e,t,a){e.exports=a(107)},80:function(e,t,a){}},[[75,1,2]]]);
//# sourceMappingURL=main.203e28c4.chunk.js.map